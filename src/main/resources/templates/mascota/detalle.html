<!DOCTYPE html>
<html lang="es" xmlns:th="http://www.thymeleaf.org" xmlns:sec="http://www.thymeleaf.org/extras/spring-security">
<head>
<meta charset="UTF-8">
<title>Detalle Mascota | Admin</title>

<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
<link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.1/font/bootstrap-icons.css" rel="stylesheet">
<script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
</head>

<body class="bg-light">
<div class="container py-4">

    <a href="/admin/mascotas" class="btn btn-outline-secondary mb-3">← Volver</a>

    <div class="row g-4">

        <!-- Card Imagen -->
        <div class="col-md-5">
            <div class="card border-0 shadow-sm h-100">
                <img th:src="${mascota.fotoUrl != null ? mascota.fotoUrl : '/images/mascotas/mascota-default.jpg'}"
                     class="card-img-top" alt="foto mascota" style="height:100%;object-fit:cover;">
            </div>
        </div>

        <!-- Card Detalles -->
        <div class="col-md-7">
            <div class="card border-0 shadow-sm mb-3">
                <div class="card-body">
                    <div class="d-flex align-items-center justify-content-between flex-wrap gap-2">
                        <h1 class="h3 mb-0" th:text="${mascota.nombre}">Nombre</h1>
                        <span class="badge bg-light text-dark" th:text="${mascota.sexo}">Sexo</span>
                    </div>
                    <div class="row g-2 mt-2">
                        <div class="col-sm-6">
                            <div class="p-2 bg-light rounded">
                                <small class="text-muted d-block">Raza</small>
                                <strong th:text="${mascota.raza != null ? mascota.raza.nombre : '-'}"></strong>
                            </div>
                        </div>
                        <div class="col-sm-6">
                            <div class="p-2 bg-light rounded">
                                <small class="text-muted d-block">Categoría</small>
                                <strong th:text="${mascota.categoria != null ? mascota.categoria.nombre : '-'}"></strong>
                            </div>
                        </div>
                        <div class="col-sm-6">
                            <div class="p-2 bg-light rounded">
                                <small class="text-muted d-block">Edad</small>
                                <strong><span th:text="${mascota.edad}"></span> años</strong>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="card border-0 shadow-sm mb-3">
                <div class="card-body">
                    <h5 class="card-title">Descripción</h5>
                    <p class="mb-0 text-muted" th:text="${mascota.descripcion}">Descripción</p>
                </div>
            </div>

            <!-- Card Solicitud de Adopción -->
            <div sec:authorize="hasRole('ADOPTANTE')" class="card border-0 shadow-sm">
                <div class="card-body">
                    <div class="d-flex flex-column flex-md-row align-items-md-center justify-content-between gap-3">
                        <div>
                            <h5 class="card-title mb-1">Solicitar adopción</h5>
                            <p class="text-muted small mb-0">
                                Queremos asegurarnos de que cada mascota llegue a un hogar ideal. Completa estos datos para conocer mejor tu situación y plan de cuidado.
                            </p>
                        </div>
                        <button class="btn btn-success"
                                type="button"
                                data-bs-toggle="collapse"
                                data-bs-target="#solicitudAdopcion"
                                th:attr="aria-expanded=${param.adoptar != null}">
                            Adoptar
                        </button>
                    </div>
                    <div id="solicitudAdopcion" class="collapse mt-4" th:classappend="${param.adoptar != null} ? ' show' : ''">
                        <form th:action="@{/adopcion/solicitar}" method="post" class="row g-3">
                            <input type="hidden" th:name="${_csrf.parameterName}" th:value="${_csrf.token}"/>
                            <input type="hidden" name="mascota.id" th:value="${mascota.id}"/>
                            
                            <!-- Campos -->
                            <div class="col-12">
                                <label class="form-label lp-label">¿Por qué quieres adoptarlo?</label>
                                <textarea name="pqAdoptar" class="form-control" rows="3" minlength="20" maxlength="600" required
                                          placeholder="Cuéntanos qué te motivó y cómo encaja esta mascota en tu familia."></textarea>
                            </div>
                            <div class="col-md-6">
                                <label class="form-label lp-label">Tipo de vivienda</label>
                                <select name="tipoVivienda" class="form-select" required>
                                    <option value="" selected disabled>Selecciona una opción</option>
                                    <option value="Casa con patio">Casa con patio</option>
                                    <option value="Casa sin patio">Casa sin patio</option>
                                    <option value="Departamento">Departamento</option>
                                    <option value="Otro">Otro</option>
                                </select>
                            </div>
                            <div class="col-md-6">
                                <label class="form-label lp-label">Experiencia con mascotas</label>
                                <select name="experiencia" class="form-select" required>
                                    <option value="" selected disabled>Selecciona una opción</option>
                                    <option value="Primera vez">Es mi primera mascota</option>
                                    <option value="Experiencia previa">Ya he cuidado mascotas antes</option>
                                    <option value="Actualmente tengo mascotas">Actualmente tengo mascotas</option>
                                    <option value="Experiencia avanzada">Tengo amplia experiencia</option>
                                </select>
                            </div>
                            <div class="col-md-6">
                                <label class="form-label lp-label">¿Hay niños u otras mascotas?</label>
                                <select name="ninosOtraMascotas" class="form-select" required>
                                    <option value="" selected disabled>Selecciona una opción</option>
                                    <option value="No">No</option>
                                    <option value="Niños en casa">Sí, hay niños</option>
                                    <option value="Otras mascotas">Sí, hay otras mascotas</option>
                                    <option value="Niños y mascotas">Sí, hay niños y mascotas</option>
                                </select>
                            </div>
                            <div class="col-md-6">
                                <label class="form-label lp-label">Tiempo disponible al día</label>
                                <select name="tiempoDedicado" class="form-select" required>
                                    <option value="" selected disabled>Selecciona una opción</option>
                                    <option value="1-2 horas">1-2 horas</option>
                                    <option value="3-4 horas">3-4 horas</option>
                                    <option value="5+ horas">Más de 5 horas</option>
                                    <option value="Disponible la mayor parte del día">Disponible la mayor parte del día</option>
                                </select>
                            </div>
                            <div class="col-12">
                                <label class="form-label lp-label">Plan de cuidado</label>
                                <textarea name="planMascota" class="form-control" rows="3" minlength="20" maxlength="600" required
                                          placeholder="Describe cómo será su rutina, paseos, alimentación y atención veterinaria."></textarea>
                            </div>
                            <div class="col-12">
                                <label class="form-label lp-label">¿Puedes cubrir los costos básicos?</label>
                                <select name="cubrirCostos" class="form-select" required>
                                    <option value="" selected disabled>Selecciona una opción</option>
                                    <option value="Sí">Sí, estoy preparado(a)</option>
                                    <option value="Necesito orientación">Necesito orientación</option>
                                </select>
                                <div class="form-text">Incluye alimentación, vacunas, controles y emergencias.</div>
                            </div>
                            <div class="col-12">
                                <label class="form-label lp-label">Información adicional (opcional)</label>
                                <textarea name="infoAdicional" class="form-control" rows="3" maxlength="600"
                                          placeholder="Si deseas añadir algo más, este es el lugar."></textarea>
                            </div>
                            <div class="col-12 d-grid d-md-flex justify-content-md-end">
                                <button class="btn btn-success" type="submit">Enviar solicitud</button>
                            </div>
                        </form>
                    </div>
                </div>
            </div>

        </div>
    </div>
</div>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
<script src="/js/util/util.js"></script>

</body>
</html>
