<!DOCTYPE html>
<html lang="es" xmlns:th="http://www.thymeleaf.org">
<head>
<meta charset="UTF-8">
<title>Detalle Mascota | Admin</title>

<link
	href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css"
	rel="stylesheet">
<link
	href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.1/font/bootstrap-icons.css"
	rel="stylesheet">
<script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
</head>

<body class="bg-light">

	<div class="container py-4">

		<a href="/admin/mascotas" class="btn btn-outline-secondary mb-3">
			← Volver </a>

		<div class="row g-4">

			<!-- Imagen -->
			<div class="col-md-6">
				<img
					th:src="${mascota.fotoUrl != null ? mascota.fotoUrl : '/images/mascotas/mascota-default.jpg'}"
					class="img-fluid rounded shadow">
			</div>

				<!-- Detalle -->
				<div class="col-md-6">

					<div class="card shadow-sm border-0">
						<div class="card-body">
							<div class="d-flex flex-wrap align-items-center justify-content-between gap-2 mb-3">
								<h3 class="fw-bold mb-0" th:text="${mascota.nombre}"></h3>

								<div>
									<span class="badge bg-success"
										th:if="${mascota.estado != null and mascota.estado.id == 'DISPONIBLE'}">
										DISPONIBLE </span> <span class="badge bg-warning text-dark"
										th:if="${mascota.estado != null and mascota.estado.id == 'NO_DISPONIBLE'}">
										NO DISPONIBLE </span> <span class="badge bg-secondary"
										th:if="${mascota.estado != null and mascota.estado.id == 'ADOPTADA'}">
										ADOPTADA </span>
								</div>
							</div>

							<div class="row g-3">
								<div class="col-sm-6">
									<div class="border rounded-3 p-3 bg-light h-100">
										<p class="text-uppercase text-muted small mb-1">Categoría</p>
										<p class="fw-semibold mb-0" th:text="${mascota.categoria.nombre}"></p>
									</div>
								</div>
								<div class="col-sm-6">
									<div class="border rounded-3 p-3 bg-light h-100">
										<p class="text-uppercase text-muted small mb-1">Raza</p>
										<p class="fw-semibold mb-0" th:text="${mascota.raza.nombre}"></p>
									</div>
								</div>
								<div class="col-sm-6">
									<div class="border rounded-3 p-3 bg-light h-100">
										<p class="text-uppercase text-muted small mb-1">Edad</p>
										<p class="fw-semibold mb-0"><span th:text="${mascota.edad}"></span> años</p>
									</div>
								</div>
								<div class="col-sm-6">
									<div class="border rounded-3 p-3 bg-light h-100">
										<p class="text-uppercase text-muted small mb-1">Sexo</p>
										<p class="fw-semibold mb-0" th:text="${mascota.sexo}"></p>
									</div>
								</div>
								<div class="col-12">
									<div class="border rounded-3 p-3 bg-light">
										<p class="text-uppercase text-muted small mb-1">Descripción</p>
										<p class="mb-0" th:text="${mascota.descripcion}"></p>
									</div>
								</div>
							</div>

							<div class="border rounded-3 p-3 mt-4">
								<p class="text-uppercase text-muted small mb-1">Publicada por</p>
								<p class="fw-semibold mb-0">
									<i class="bi bi-person me-1"></i>
									<span th:text="${mascota.usuarioCreacion != null ? mascota.usuarioCreacion.username : 'Sistema'}"></span>
								</p>
							</div>

							<div class="d-grid gap-2 mt-4">
								<form th:action="@{/admin/mascotas/{id}/estado(id=${mascota.id})}"
									method="post"
									th:if="${mascota.estado!= null and mascota.estado.id != 'ADOPTADA'}"
									data-confirm="true"
									th:data-confirm-title="${mascota.estado.id == 'DISPONIBLE'} ? '¿Bloquear mascota?' : '¿Activar mascota?'"
									th:data-confirm-text="${mascota.estado.id == 'DISPONIBLE'} ? 'La mascota dejará de estar disponible.' : 'La mascota volverá a estar disponible.'"
									th:data-confirm-button="${mascota.estado.id == 'DISPONIBLE'} ? 'Sí, bloquear' : 'Sí, activar'">

									<input type="hidden" th:name="${_csrf.parameterName}"
										th:value="${_csrf.token}">

									<button class="btn btn-sm w-100"
										th:classappend="${mascota.estado.id == 'DISPONIBLE'}
					            ? 'btn-outline-danger'
					            : 'btn-outline-success'">

										<i class="bi"
											th:classappend="${mascota.estado.id == 'DISPONIBLE'}
					                ? 'bi-slash-circle'
					                : 'bi-check-circle'"></i>

										<span
											th:text="${mascota.estado.id == 'DISPONIBLE'}
					                ? 'Bloquear'
					                : 'Activar'">
										</span>
									</button>
								</form>

								<a th:if="${mascota.usuarioCreacion != null}"
									th:href="@{/admin/usuarios/{id}(id=${mascota.usuarioCreacion.id})}"
									class="btn btn-sm btn-outline-primary w-100"> Ver usuario </a>
							</div>
						</div>
					</div>

				</div>
		</div>
	</div>

	<script src="/js/util/util.js"></script>
</body>
</html>
