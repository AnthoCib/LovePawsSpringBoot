<!DOCTYPE html>
<html lang="es"
      xmlns:th="http://www.thymeleaf.org"
      xmlns:sec="http://www.thymeleaf.org/extras/spring-security">

<head>
    <meta charset="UTF-8">
    <title>Mascotas | Admin</title>

    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.1/font/bootstrap-icons.css" rel="stylesheet">
    <link th:href="@{/css/admin.css}" rel="stylesheet">
</head>

<body class="admin-dark">

<div class="d-flex">

    <!-- SIDEBAR -->
    <div th:replace="fragments/admin-sidebar :: adminSidebar"></div>

    <!-- CONTENIDO -->
    <main class="admin-content w-100 p-4">

        <h2 class="fw-bold mb-4">üêæ Gesti√≥n de Mascotas</h2>

        <div class="row g-4">

            <div class="col-xl-3 col-lg-4 col-md-6" th:each="m : ${mascotas}">
                <div class="card mascota-card h-100 shadow-sm">

                    <img th:src="${m.fotoUrl != null ? m.fotoUrl : '/images/mascotas/mascota-default.jpg'}"
                         class="card-img-top">

                    <div class="card-body">

                        <h5 th:text="${m.nombre}">Nombre</h5>

                        <p class="text-muted mb-1">
                            <i class="bi bi-tags"></i>
                            <span th:text="${m.categoria.nombre}"></span> ¬∑
                            <span th:text="${m.raza.nombre}"></span>
                        </p>

                        <p class="text-muted mb-2">
                            <i class="bi bi-person"></i>
                            Publicado por
                            <b th:text="${m.usuarioCreacion != null ? m.usuarioCreacion.username : 'Sistema'}"></b>
                        </p>

                        <!-- ESTADO -->
                        <span class="badge bg-success"
                              th:if="${m.estado != null and m.estado.id == 'DISPONIBLE'}">DISPONIBLE</span>

                        <span class="badge bg-warning text-dark"
                              th:if="${m.estado != null and m.estado.id == 'NO_DISPONIBLE'}">NO DISPONIBLE</span>

                        <span class="badge bg-secondary"
                              th:if="${m.estado != null and m.estado.id == 'ADOPTADA'}">ADOPTADA</span>
                    </div>

                    <div class="card-footer bg-transparent border-0">
                        <div class="d-grid gap-2">

                            <!-- Ver detalle (ADMIN) -->
                            <a th:href="@{/admin/mascotas/{id}(id=${m.id})}"
                               class="btn btn-outline-primary btn-sm"
                               sec:authorize="hasRole('ADMIN')">
                                üëÅÔ∏è Ver detalle
                            </a>

                            <!-- Editar (GESTOR, solo si no est√° adoptada) -->
                            <a th:href="@{/gestor/mascotas/editar/{id}(id=${m.id})}"
                               class="btn btn-outline-warning btn-sm"
                               sec:authorize="hasRole('GESTOR')"
                               th:if="${m.estado != null and m.estado.id != 'ADOPTADA'}">
                                ‚úèÔ∏è Editar
                            </a>

                        </div>
                    </div>

                </div>
            </div>

            <!-- Sin mascotas -->
            <div th:if="${#lists.isEmpty(mascotas)}"
                 class="text-center text-muted py-5">
                No hay mascotas registradas
            </div>

        </div>

    </main>
</div>

</body>
</html>
